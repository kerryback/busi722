\documentclass[aspectratio=169]{beamer}
\usetheme{metropolis}

\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath}
\input{busi722-style}

\title{Forming and Evaluating Portfolios}
\subtitle{BUSI 722: Data-Driven Finance II}
\author{Kerry Back}
\institute{}
\date{}

\begin{document}

\maketitle

%%% PART 1: MAPPING PREDICTIONS TO WEIGHTS %%%

\begin{frame}[c]
\centering
\Huge From Predictions to Portfolio Weights
\end{frame}

\begin{frame}{The Setup}
From Session 4, we have one-step-ahead predicted return ranks for every stock in every month.

\vspace{0.3cm}
How do we translate these predictions into \alert{portfolio weights}?

\vspace{0.3cm}
We need a function $w_i = g(\text{rank}_i)$ that maps each stock's predicted rank to a portfolio weight.
\begin{itemize}
\item The function should be \alert{monotone}: higher predicted rank $\Rightarrow$ larger weight.
\item There are many valid choices, from simple to sophisticated.
\end{itemize}
\end{frame}

\begin{frame}{Sort-Based Portfolios}
The simplest approach: sort stocks by predicted rank and equal-weight within groups.
\vspace{0.3cm}

\textbf{Long-only (top decile):}
\begin{itemize}
\item Buy the top 10\% of stocks, equal-weighted.
\item Weight $= 1/n$ for stocks in the top decile, 0 otherwise.
\end{itemize}

\vspace{0.3cm}
\textbf{Long-short (top minus bottom):}
\begin{itemize}
\item Buy the top 10\%, short the bottom 10\%, equal-weighted within each.
\item Weight $= +1/n$ for the top decile, $-1/n$ for the bottom decile, 0 otherwise.
\end{itemize}

\vspace{0.3cm}
The weight function is a \alert{step function} of the predicted rank.
\end{frame}

\begin{frame}{Sorting Is a Monotone Weight Function}
Whether we go long the top decile or long-short top versus bottom, the weights are \alert{monotone} in the predicted rank:
\begin{itemize}
\item A stock with a higher predicted rank gets a weight that is at least as large as a stock with a lower predicted rank.
\end{itemize}

\vspace{0.3cm}
\alert{Sorting and equal-weighting within groups is just one particular monotone function mapping predictions to weights.  There are many others.}
\end{frame}

\begin{frame}{Pros and Cons of Sorting}
\textbf{Advantages:}
\begin{itemize}
\item Simple, transparent, widely used in academic research.
\item Robust to outliers in predictions --- extreme predictions within a group get the same weight.
\end{itemize}

\vspace{0.3cm}
\textbf{Disadvantages:}
\begin{itemize}
\item \alert{Throws away information:} a stock barely in the top decile gets the same weight as the top-ranked stock.
\item Sensitive to the choice of breakpoints (quintiles? deciles?).
\item Discontinuous: a tiny change in predicted rank can move a stock from one group to another, causing unnecessary turnover.
\end{itemize}
\end{frame}

%%% PART 2: SMOOTH MONOTONE WEIGHT FUNCTIONS %%%

\begin{frame}[c]
\centering
\Huge Smooth Weight Functions
\end{frame}

\begin{frame}{Weights as a Function of Normalized Rank}
Scale predicted ranks to $[0, 1]$:
\[
u_i = \frac{\text{rank}_i}{n}
\]
Then set portfolio weights as a monotone function of $u_i$.

\vspace{0.3cm}
\begin{itemize}
\item This uses the \alert{entire cross section} of predictions, not just the extremes.
\item No arbitrary breakpoints.
\item Different function shapes express different views about how aggressively to concentrate in top-ranked stocks.
\end{itemize}
\end{frame}

\begin{frame}{Linear Weights}
The simplest smooth weight function:
\[
w_i \;\propto\; u_i - \bar u
\]
where $\bar u = 0.5$ is the median rank.

\begin{itemize}
\item Stocks above the median get positive weights; below get negative.  Dollar-neutral by construction.
\item Every stock's weight is proportional to its \alert{distance from the median rank}.
\item Equal spacing: the difference in weight between any two adjacent-ranked stocks is the same.
\end{itemize}
\end{frame}

\begin{frame}{Power Functions}
Apply a power transformation to the normalized rank:
\[
w_i \;\propto\; u_i^{\,p} - c
\]
where $c$ is chosen so that weights sum to zero.

\vspace{0.3cm}
\begin{itemize}
\item $p = 1$: linear weights (equal spacing).
\item $p > 1$ (convex): \alert{concentrates} weight in the top-ranked stocks.  Higher $p$ = more aggressive.
\item $0 < p < 1$ (concave): \alert{spreads} weight more evenly.  Less concentration at the top.
\end{itemize}

\vspace{0.3cm}
The parameter $p$ controls the trade-off between \alert{conviction} (concentrating in the best predictions) and \alert{diversification} (spreading weight across many stocks).
\end{frame}

\begin{frame}{Exponential Tilts}
Apply an exponential transformation:
\[
w_i \;\propto\; e^{\lambda u_i} - c
\]

\begin{itemize}
\item $\lambda > 0$: tilts toward top-ranked stocks; larger $\lambda$ means more aggressive concentration.
\item $\lambda \to 0$: converges to equal weights.
\item $\lambda \to \infty$: concentrates all weight in the top-ranked stock.
\end{itemize}

\vspace{0.3cm}
The exponential tilt is related to the \alert{softmax} function used in neural networks.  With a temperature parameter $T = 1/\lambda$, the softmax assigns:
\[
w_i = \frac{e^{u_i / T}}{\sum_j e^{u_j / T}}
\]
This produces long-only weights that sum to one.
\end{frame}

\begin{frame}{Comparing Weight Functions}
\begin{center}
\begin{tabular}{lll}
\textbf{Function} & \textbf{Shape} & \textbf{Character} \\
\hline
Step (sort-based) & flat within groups & simple, discontinuous \\
Linear & straight line & smooth, moderate \\
Power ($p > 1$) & convex & concentrates at the top \\
Power ($p < 1$) & concave & more diversified \\
Exponential & convex & aggressively concentrates \\
Softmax & convex, long-only & all weights positive \\
\end{tabular}
\end{center}

\vspace{0.3cm}
All of these are \alert{monotone}: a higher predicted rank always means a larger weight.  They differ in how much they \alert{differentiate} between stocks near the top versus the middle.
\end{frame}

%%% PART 3: LONG-ONLY CONSIDERATIONS %%%

\begin{frame}[c]
\centering
\Huge Long-Only Considerations
\end{frame}

\begin{frame}{Why Long-Only?}
Most investors cannot short stocks.  Even those who can face:
\begin{itemize}
\item Short-selling costs (borrowing fees, margin requirements).
\item Short squeezes and recall risk.
\item Regulatory constraints (many funds are long-only by mandate).
\end{itemize}

\vspace{0.3cm}
\textbf{Long-only weight functions:}
\begin{itemize}
\item Softmax: $w_i = e^{\lambda u_i} / \sum_j e^{\lambda u_j}$
\item Truncated: set $w_i = 0$ for stocks below a rank threshold, then equal-weight or rank-weight the rest.
\item Score-tilted market cap: $w_i \propto \text{mcap}_i \cdot g(u_i)$
\end{itemize}
\end{frame}

\begin{frame}{Score-Tilted Market-Cap Weights}
Start with market-cap weights and tilt toward higher-ranked stocks:
\[
w_i \;\propto\; \text{mcap}_i \times g(u_i)
\]
where $g$ is a monotone increasing function (e.g., $g(u) = u^p$ or $g(u) = e^{\lambda u}$).

\vspace{0.3cm}
\begin{itemize}
\item Stays close to the investable market-cap benchmark; large stocks retain significant weight even with low ranks.
\item More realistic for large portfolios --- avoids overweighting micro-caps.
\item The tilt function $g$ controls how much the portfolio deviates from the benchmark.
\end{itemize}
\end{frame}

%%% PART 4: EVALUATING PORTFOLIO RETURNS %%%

\begin{frame}[c]
\centering
\Huge Evaluating Portfolio Returns
\end{frame}

\begin{frame}{Portfolio Returns}
Once we choose a weight function, we compute the portfolio return each month:
\[
r_{p,t} = \sum_{i=1}^{n_t} w_{i,t}\, r_{i,t}
\]

\begin{itemize}
\item $w_{i,t}$ = weight of stock $i$ in month $t$ (from the weight function applied to predicted ranks).
\item $r_{i,t}$ = realized return of stock $i$ in month $t$.
\item This gives us a time series of monthly portfolio returns: $r_{p,1}, r_{p,2}, \ldots, r_{p,T}$.
\end{itemize}
\end{frame}

\begin{frame}{Sharpe Ratio}
The \alert{Sharpe ratio} measures risk-adjusted excess return:
\[
\text{Sharpe} = \frac{\bar r_p - r_f}{\sigma_p}
\]

\begin{itemize}
\item $\bar r_p$ = mean monthly portfolio return; $r_f$ = risk-free rate.
\item $\sigma_p$ = standard deviation of monthly portfolio returns.
\item Annualize by multiplying by $\sqrt{12}$.
\end{itemize}

\vspace{0.3cm}
A higher Sharpe ratio means more return per unit of risk.  For a long-short portfolio, $r_f$ is often set to zero (the portfolio is self-financing).
\end{frame}

\begin{frame}{CAPM Alpha}
Regress the portfolio's excess return on the market's excess return:
\[
r_{p,t} - r_{f,t} = \alpha + \beta (r_{m,t} - r_{f,t}) + \varepsilon_t
\]

\begin{itemize}
\item $\alpha$ = the portfolio's \alert{average return not explained by market exposure}.
\item $\beta$ = the portfolio's sensitivity to the market.
\item $\varepsilon_t$ = residual (idiosyncratic) return.
\end{itemize}

\vspace{0.3cm}
A positive $\alpha$ means the portfolio earns more than its market beta would predict.  This is what active management aims to deliver.
\end{frame}

\begin{frame}{Is Alpha Statistically Significant?}
The regression also gives us a standard error for $\alpha$, and hence a $t$-statistic:
\[
t = \frac{\hat\alpha}{\text{SE}(\hat\alpha)}
\]

\begin{itemize}
\item $|t| > 2$ is a rough rule for significance at the 5\% level.
\item With monthly data over 10 years (120 observations), we need economically large alphas to achieve significance.
\item \alert{Always report the $t$-statistic}, not just the alpha estimate.
\end{itemize}
\end{frame}

\begin{frame}{CAPM Information Ratio}
The \alert{information ratio} measures alpha relative to the volatility of the residuals:
\[
\text{IR} = \frac{\hat\alpha}{\sigma(\varepsilon)}
\]

\begin{itemize}
\item $\hat\alpha$ = estimated CAPM alpha.
\item $\sigma(\varepsilon)$ = standard deviation of the regression residuals (``tracking error'' relative to the CAPM benchmark).
\item The IR measures how \alert{consistently} the portfolio delivers alpha.
\end{itemize}

\vspace{0.3cm}
\textbf{Interpretation:}
\begin{itemize}
\item The Sharpe ratio measures total risk-adjusted return.
\item The information ratio measures \alert{skill} --- alpha per unit of idiosyncratic risk.
\item Annualize by multiplying by $\sqrt{12}$.
\end{itemize}
\end{frame}

\begin{frame}{Comparing the Three Metrics}
\begin{center}
\begin{tabular}{lll}
\textbf{Metric} & \textbf{Numerator} & \textbf{Denominator} \\
\hline
Sharpe ratio & excess return $\bar r_p - r_f$ & total volatility $\sigma_p$ \\
CAPM alpha & $\hat\alpha$ & (reported with $t$-stat) \\
Information ratio & $\hat\alpha$ & residual volatility $\sigma(\varepsilon)$ \\
\end{tabular}
\end{center}

\vspace{0.3cm}
\begin{itemize}
\item The Sharpe ratio evaluates the portfolio as a \alert{standalone investment}.
\item Alpha and the IR evaluate it as an \alert{addition to the market portfolio}.
\item A portfolio can have a high Sharpe ratio but zero alpha (if it just loads on market risk), or a high IR but low Sharpe ratio (if alpha is consistent but small).
\end{itemize}
\end{frame}

\begin{frame}{Putting It Together}
\begin{enumerate}
\item Generate one-step-ahead predicted ranks and choose a weight function (sort-based, linear, power, exponential, softmax, or score-tilted).
\item Compute monthly portfolio returns.
\item Evaluate: Sharpe ratio, CAPM alpha (with $t$-stat), and information ratio.  Session 6 extends to Fama-French factors and other considerations.
\end{enumerate}
\end{frame}

\end{document}
